---
title: "TokenID Removal Without Prior Reward Collection â€” A High-Severity Vault Accounting Bug"
layout: default
---

# Security Vulnerability Report

## ğŸ“‹ Report Details
- **Platform:** Sherlock
- **Report Submission:** November 2025
- **Severity:** High
- **Status:** Accepted

---

## ğŸ¯ Protocol Overview

stNXM is a liquid staking protocol for NXM tokens on the Nexus Mutual insurance platform. It offers fractional reserve staking, allowing holders to stake NXM for rewards while keeping liquidity through the stNXM tokenâ€”no lock-ups required. Key perks include auto-compounding yields, composability for DeFi uses like lending collateral on Morpho or liquidity on Uniswap, and a hands-off "set-and-forget" model. It's designed for NXM holders wanting flexible, high-return DeFi underwriting exposure.

---

## ğŸ” Vulnerability Summary

### Quick Overview
[2-3 sentence summary of the vulnerability - what it is and why it matters]

**Vulnerability Type:** [e.g., Reentrancy, Access Control, Logic Error, Price Manipulation]

**Attack Complexity:** [Low/Medium/High]

**Affected Component:** [Smart contract name, function, or module]

---

## ğŸ› Deep Dive into the Bug

### Technical Details

#### Root Cause
[Detailed explanation of what caused the vulnerability - code logic, missing checks, architectural flaw, etc.]

#### Exploitation Scenario
[Step-by-step walkthrough of how an attacker could exploit this vulnerability]

1. Step 1
2. Step 2
3. Step 3

#### Proof of Concept
```solidity
// Code snippet or pseudocode demonstrating the exploit
```

### Why This Matters
[Explanation of the underlying security principle violated and why this pattern is dangerous]

---

## ğŸ’¥ Impact Assessment

### Potential Consequences
- **Financial Impact:** [e.g., Loss of funds, unauthorized minting, price manipulation]
- **Protocol Impact:** [e.g., Protocol insolvency, loss of user trust]
- **User Impact:** [e.g., Loss of user funds, locked assets]

### Worst-Case Scenario
[Description of maximum damage if exploited]

### Affected Users/Funds
[Scope of impact - number of users, dollar amount at risk]

---

## ğŸ”— Full Report

**Read the complete detailed report here:** [Link to your full report - GitHub, HackerOne, Immunefi, etc.]

---

## ğŸ“š Lessons Learned

[Optional section - key takeaways, similar vulnerabilities to watch for, best practices]

---

## ğŸ† Recognition

[Optional - if you received a bounty or acknowledgment]
- **Bounty Amount:** $X,XXX
- **Hall of Fame:** [Link if applicable]

---

**Disclaimer:** This report is shared for educational purposes. All vulnerabilities were responsibly disclosed to the protocol team before public disclosure.
